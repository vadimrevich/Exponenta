
[[16.05.2018]]

Сегодня на тестовом компьютере попытался его "взломать" средствами программного комплекса DameWare. Вышло следующее.

1. К компьютеру жертве, в любом случае, без вариантов, можно подключиться только под учётной записью локального администратора, чтобы можно было установить сервисы DameWare. У меня не прошла установка даже под административной учётной записью в Windows 7.

2. DameWare не подключается к учётным записям, у которых отсутствует пароль, а также к заблокированным учётным записям. Это значительно осложняет удалённое подключение к компьютерам в реальной ситуации. По умолчанию Microsoft Windows устанавливается с учётной записью администратора без пароля, а учётная запись администратора не содержит пароля и про умолчанию отключена. Как попасть на такой компьютер, у меня нет идей. Если только воспользоваться своим эксплоитом, хотя это будет заметно и небезопасно.

3. При подключении MRC DameWare экран компьютера-жертвы "дёргается", и на нём пропадают обои. И это не смотря на то, что включён самый "тихий" режим наблюдения. Иначе говоря, без дополнительной разведки, которая включает в себя определение типа дисплея и видеокарты, настройки разрешения и цветности экрана, подключение к компьютеру невозможно без риска быть раскрытым.

4. Сервисы DameWare нормально работают в локальной сети, даже между компьютерами в разных доменах, но сервис чувствителен к NAT и Proxy технологиям -- они просто не пропускают трафик. Причём это в меньшей степени касается консольного доступа, который автоматически обходит защиту брандмауэра и закрытых портов. Для работы же MRC необходимо открыть на маршрутизаторе порт по умолчанию (задаётся в настройках).

5. При работе MRC с закрытым портом по-умолчанию не удалось запустить Mirror Driver, хотя связь установить удалось.

6. При переконфигурации сети и DameWare клиента лучше не пытаться установить соединение со старым сервером, а удалить и заново установить на нём клиент.

7. Мною не тестировалось подключение клиентского компьютера к серверу DameWare  с отключённым на нём сервисами SMB протоколов (порты 137-139, 455). Эти порты не обязательно должны быть проброшены, но обязательно открыты, и чтобы к компьютеру было возможно подключение по SMB (CIF) протоколу (общие папки). Так по крайней мере написано в инструкции к программе DameWare. В домашних компьютерах эти порты по-умолчанию закрыты, а на рабочих компьютерах -- открыты. Эти же порты используются для проникновения вирусов WannaCry и Pete, а потому их советуют всегда держать закрытыми. Что намного усложняет удалённое подключение.

Полезным дополнением к программе проникновения был бы кейлоггер, который я недавно скачал из Интернета. По заверениям авторов, кейлоггер вроде бы не "палится", и обладает широкими возможностями управления. А главное, он бесплатный. Но ни кейлоггер, ни эксплоит не являются в данном случае универсальным средством. Хотя бы потому, что их нужно доставить на компьютер жертвы, и запустить с правами локального администратора. Но в любом случае сочетание эксплоит+кейлоггер намного лучше и эффективнее банального фишинга.

Однако, в свете всего вышесказанного, создаётся впечатление, что домашний компьютер можно взломать только методом социальной инженирии. То есть заставить пользователя самого сделать опасные шаги, пользуясь подсказками хакера. Или самому хакеру нужно заиметь физический доступ к компьютеру, для запуска зловредов со своего сайта.

[21:05:44]

В качестве метода социальной инженерии для запуска эксплоита можно использовать следующий приём. Жертва получает якобы от своего знакомого электронное сообщение с сылкой на видео. Важно, что письмо отправляется по электронной почте -- тогда вероятность его открытия на компьютере будет выше. По ссылке передаётся программа -- распространитель эксплоита, которая имеет расширение, например, ролик.mp4.exe, с иконкой ролика формата MP4. По-умолчанию расширение файла скрывается, так что вероятность того, что пользователь не заметит, что это исполняемый файл, очень велика.

Этот EXE файл содержит в себе не сам зловред или его инсталлятор (что было бы тривиально и легко детектировалось антивирусом), а скрипт с вложениями, который загружает инсталлятор, сопутствующие программы эксплоита и кейлоггера, в том числе и сам MP4 файл. Затем, после скачивания и установки, этот файл запускается на проигрывание, а оригинальный файл удаляется тем же скриптом.

Этот алгоритм подходит для заражения компьютеров как в Windows, так и UNIX-подобных. На UNIX подобных операционных системах этот способ затруднён только тем, что нужно заставить пользователя запустить файл с правами суперпользователя. В Windows в этом нужды нет, поскольку изначально существуют утилиты, запускающие программы с правами суперпользователя. А еслши эта программа -- скрипт, то тут уже и антивирус не в помомщь, поскольку в операционных системах Microsoft предусмотрена возможность принудительного запуска скрипта с правами администратора, при условии, что он использует только системные вызовы.

Bingo! Не забудьте после заражения заменить ссылку на файл, чтобы избежать повторного заражения или заражения нецелевой аудитории.

Кстати о такого рода фишинге. Не смотря на кажущуюся простоту и банальность, способ этот работает и будет работать вечно. Если знакомый хочет показать тебе прикольное видео с танцующими свиньями, то тут не только пользователь, но и администратор теряет голову. Проверенно, работает! Самое сложное в этом способе -- это указать время и целевую аудиторию. С тем, чтобы жертва не открыла файл на телефоне или на рабочем компьютере!

Теперь о существенном недостатке в безопасности данного метода. Любой специалист по безопасности сразу обнаржит FTP сервер, на который будет передаваться информация, с которого обязательно выйдут на вашу персоналию. По новому законодательству, анонимные FTP сервисы запрещены. Ни один провайдер не организует Вам неавторизированный FTP доступ и даже "приватный" доступ без Ваших идентификационных данных. В лучшем случае это e-mail и телефон, в худшем -- паспортные данные и данные вашей кредитной карты. На собственный хостинг также мало надежды -- постоянный IP адрес также предоставляется при предъявлении паспортных данных, а на DynDNS также мало надежды. Вариант -- использовать иностранный туннельный брокер, но тогда Вы ограничиваетесь протоколом IPv6 и сложностью в использовании DynDNS, не говоря уже о том, что провайдер всё равно вас вычислит по MAC адресу. Но использование туннельного брокера в настоящее время является лучшим способом анонимности, исключая технологии VPN. Да, забыл отметить, что технологии VPN использовать в хакерских целях затруднительно, из-за регулирования этого рынка услуг различными государственными и коммерческими органами. Вам просто никте не даст развернуть FTP сервер на VPN соединении -- смотри материал выше.

[21:51:20]

Завтра попытаюсь запустить кейлоггер плюс эксплоит в тестовой среде на виртуальной машине. Заодно постараюсь написать деинсталлятор данной программы. А пока настрою тестовую среду.

Тестовая среда представляет собой гостевую виртуальную машину Microsoft Windows 7 32-bit в Oracle VirtualBox, с установленными обновлениями безопасности, антивирусом по-умолчанию и средой запуска приложений в "песочнице". Эта конфигурация будет считаться оптимальной для тестирования -- более защищённый компьютер трудно себе представить. Как и в реальной жизни, на нём будут отсутствовать пароли, а учётная запись администратора будет отключена. Конечная цель эксперимента -- получить уязвиммую систему для удалённого управления ею. Все действия должны быть, во-первых, максимально автоматизированы, во-вторых, скрыты, в третьих, быть универсальными.

Предполагается, что компьютер подключён к Интернет, а его домашний маршрутизатор уже взломан. то есть компьютер расположен не за NAT или прокси сервером. В дальнейшем нужно будет избавиться от такого рода предположений, разместив гостевую ОС в другой подсети, не связанной логически с домашней сетью.

Кроме приложения "песочница", на хост компьютере и гостевой ОС должны быть расположены анализаторы трафикаи сетевые утилиты, с помощью которых можно было бы наблюдать за процессом взлома в реальном времени. 

Само собой разумеется, что на сервере должны быть созданы учётные записи для взлома. Впрочем, они уже есть. ;-)


